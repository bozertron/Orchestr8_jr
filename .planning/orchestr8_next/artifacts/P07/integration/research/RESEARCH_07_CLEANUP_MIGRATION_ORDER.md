# Phase 07: Artifact Cleanup + Migration Order - Research

**Researched:** 2026-02-16  
**Domain:** a_codex_plan cleanup and migration phase ordering  
**Confidence:** HIGH

---

## Summary

This research identifies all artifact clutter in the `a_codex_plan/` root directory and validates the proposed migration phase order. The cleanup involves moving 33 files to `.planning/artifacts/P07/` and deleting 7 temporary log files. The migration phases are validated with test gates, rollback plans, and dependency analysis.

**Primary recommendation:** Execute cleanup Phase 1 (artifact move) first as it's risk-free with immediate visual clarity, then proceed through phases in the proposed order with Phase 0 (color tokens) being optional but recommended.

---

## 1. Artifact Inventory

### 1.1 Complete File List in Root

| File | Type | Classification | Rationale |
|------|------|----------------|-----------|
| a_codex_plan.code-workspace | config | KEEP | IDE workspace config |
| ACP_03_TEST_OUTPUT.txt | test output | MOVE | Test artifact, goes to artifacts |
| ALL_B5_TESTS.txt | test output | MOVE | Test artifact, goes to artifacts |
| B1_INTEGRATION_SMOKE_REPORT.md | report | MOVE | Smoke report, goes to artifacts |
| B2_INTEGRATION_SMOKE_REPORT.md | report | MOVE | Smoke report, goes to artifacts |
| B3_INTEGRATION_SMOKE_REPORT.md | report | MOVE | Smoke report, goes to artifacts |
| B3_TEST_OUTPUT.txt | test output | MOVE | Test artifact, goes to artifacts |
| B4_INTEGRATION_SMOKE_REPORT.md | report | MOVE | Smoke report, goes to artifacts |
| B4_TEST_OUTPUT.txt | test output | MOVE | Test artifact, goes to artifacts |
| B5_INTEGRATION_SMOKE_REPORT.md | report | MOVE | Smoke report, goes to artifacts |
| B5_TEST_OUTPUT.txt | test output | MOVE | Test artifact, goes to artifacts |
| B6_FINAL_TESTS.txt | test output | MOVE | Test artifact, goes to artifacts |
| B6_INTEGRATION_SMOKE_REPORT.md | report | MOVE | Smoke report, goes to artifacts |
| B6_TEST_OUTPUT.txt | test output | MOVE | Test artifact, goes to artifacts |
| .coverage | coverage | KEEP | Generated by test runs, keep in root |
| curl_proof.log | log | DELETE | Temporary debug log |
| cutover_test.log | log | DELETE | Temporary debug log |
| inbox_dump.txt | data | KEEP | May contain runtime data |
| lib/ | directory | KEEP | External lib directory |
| marimo_startup.log | log | DELETE | Temporary debug log |
| marimo_startup_retry.log | log | DELETE | Temporary debug log |
| obs_1664.txt | data | KEEP | May contain runtime data |
| orchestr8_next/ | package | KEEP | Core package |
| orchestr8_next.egg-info/ | metadata | KEEP | Package metadata |
| .planning/ | planning | KEEP | Planning directory |
| ping_completion_output.txt | data | KEEP | May contain runtime data |
| pyproject.toml | config | KEEP | Package definition |
| pytest.ini | config | KEEP | Test configuration |
| requirements.txt | config | KEEP | Dependencies |
| rollback_test.log | log | DELETE | Temporary debug log |
| .pytest_cache/ | cache | KEEP | Test cache |
| .ruff_cache/ | cache | KEEP | Linter cache |
| scripts/ | directory | KEEP | CLI tools |
| smoke_city.txt | log | DELETE | Temporary debug log |
| smoke_reliability.txt | log | DELETE | Temporary debug log |
| test_binary_output.txt | test output | MOVE | Test artifact, goes to artifacts |
| TEST_CS_FAIL.txt | test output | MOVE | Test artifact, goes to artifacts |
| test_graphs_output.txt | test output | MOVE | Test artifact, goes to artifacts |
| test_output_2.txt | test output | MOVE | Test artifact, goes to artifacts |
| TEST_OUTPUT_B2.txt | test output | MOVE | Test artifact, goes to artifacts |
| test_output_rel.txt | test output | MOVE | Test artifact, goes to artifacts |
| test_output.txt | test output | MOVE | Test artifact, goes to artifacts |
| test_reliability_output.txt | test output | MOVE | Test artifact, goes to artifacts |
| test_wiring_output.txt | test output | MOVE | Test artifact, goes to artifacts |
| tests/ | directory | KEEP | Test suite |
| vendor/ | directory | KEEP | Vendored dependencies |
| .taskmaster/ | directory | KEEP | Task config |

### 1.2 Summary Counts

| Classification | Count | Action |
|----------------|-------|--------|
| MOVE | 24 files | Move to `.planning/artifacts/P07/` |
| DELETE | 7 files | Remove permanently |
| KEEP | 15 items | Leave in place |

---

## 2. Exact Cleanup Commands

### 2.1 Create Target Directory

```bash
mkdir -p /home/bozertron/a_codex_plan/.planning/artifacts/P07
```

### 2.2 Move Commands (24 files)

```bash
# Smoke Reports (6 files)
mv /home/bozertron/a_codex_plan/B1_INTEGRATION_SMOKE_REPORT.md /home/bozertron/a_codex_plan/.planning/artifacts/P07/
mv /home/bozertron/a_codex_plan/B2_INTEGRATION_SMOKE_REPORT.md /home/bozertron/a_codex_plan/.planning/artifacts/P07/
mv /home/bozertron/a_codex_plan/B3_INTEGRATION_SMOKE_REPORT.md /home/bozertron/a_codex_plan/.planning/artifacts/P07/
mv /home/bozertron/a_codex_plan/B4_INTEGRATION_SMOKE_REPORT.md /home/bozertron/a_codex_plan/.planning/artifacts/P07/
mv /home/bozertron/a_codex_plan/B5_INTEGRATION_SMOKE_REPORT.md /home/bozertron/a_codex_plan/.planning/artifacts/P07/
mv /home/bozertron/a_codex_plan/B6_INTEGRATION_SMOKE_REPORT.md /home/bozertron/a_codex_plan/.planning/artifacts/P07/

# Test Outputs (18 files)
mv /home/bozertron/a_codex_plan/ACP_03_TEST_OUTPUT.txt /home/bozertron/a_codex_plan/.planning/artifacts/P07/
mv /home/bozertron/a_codex_plan/ALL_B5_TESTS.txt /home/bozertron/a_codex_plan/.planning/artifacts/P07/
mv /home/bozertron/a_codex_plan/B3_TEST_OUTPUT.txt /home/bozertron/a_codex_plan/.planning/artifacts/P07/
mv /home/bozertron/a_codex_plan/B4_TEST_OUTPUT.txt /home/bozertron/a_codex_plan/.planning/artifacts/P07/
mv /home/bozertron/a_codex_plan/B5_TEST_OUTPUT.txt /home/bozertron/a_codex_plan/.planning/artifacts/P07/
mv /home/bozertron/a_codex_plan/B6_FINAL_TESTS.txt /home/bozertron/a_codex_plan/.planning/artifacts/P07/
mv /home/bozertron/a_codex_plan/B6_TEST_OUTPUT.txt /home/bozertron/a_codex_plan/.planning/artifacts/P07/
mv /home/bozertron/a_codex_plan/TEST_CS_FAIL.txt /home/bozertron/a_codex_plan/.planning/artifacts/P07/
mv /home/bozertron/a_codex_plan/TEST_OUTPUT_B2.txt /home/bozertron/a_codex_plan/.planning/artifacts/P07/
mv /home/bozertron/a_codex_plan/test_binary_output.txt /home/bozertron/a_codex_plan/.planning/artifacts/P07/
mv /home/bozertron/a_codex_plan/test_graphs_output.txt /home/bozertron/a_codex_plan/.planning/artifacts/P07/
mv /home/bozertron/a_codex_plan/test_output_2.txt /home/bozertron/a_codex_plan/.planning/artifacts/P07/
mv /home/bozertron/a_codex_plan/test_output_rel.txt /home/bozertron/a_codex_plan/.planning/artifacts/P07/
mv /home/bozertron/a_codex_plan/test_output.txt /home/bozertron/a_codex_plan/.planning/artifacts/P07/
mv /home/bozertron/a_codex_plan/test_reliability_output.txt /home/bozertron/a_codex_plan/.planning/artifacts/P07/
mv /home/bozertron/a_codex_plan/test_wiring_output.txt /home/bozertron/a_codex_plan/.planning/artifacts/P07/
```

### 2.3 Delete Commands (7 files)

```bash
rm /home/bozertron/a_codex_plan/curl_proof.log
rm /home/bozertron/a_codex_plan/cutover_test.log
rm /home/bozertron/a_codex_plan/marimo_startup.log
rm /home/bozertron/a_codex_plan/marimo_startup_retry.log
rm /home/bozertron/a_codex_plan/rollback_test.log
rm /home/bozertron/a_codex_plan/smoke_city.txt
rm /home/bozertron/a_codex_plan/smoke_reliability.txt
```

---

## 3. Migration Phase Order Validation

### 3.1 Current Test Status Baseline

| Metric | Value |
|--------|-------|
| Total tests | 68 |
| Passed | 66 |
| Failed | 2 |
| Failed tests | test_comms_bridge_dispatch, test_comms_bridge_timeout |
| Failure reason | Missing pytest-asyncio plugin |

### 3.2 Proposed Phase Order Analysis

| Phase | Name | Scope | Risk | Estimated Time |
|-------|------|-------|------|----------------|
| 0 | Color token hardcodes | 2 files, ~4 locations | LOW | 0.5 hours |
| 1 | Artifact cleanup | 33 files | NONE | 0.25 hours |
| 2 | sys.path hacks | 1 file, 3 locations | MEDIUM | 1 hour |
| 3 | L2 service facades | New files | LOW | 2 hours |
| 4 | woven_maps.py restructure | Harder, touches rendering | HIGH | 4 hours |

---

## 4. Phase-by-Phase Analysis

### Phase 0: Fix Color Token Hardcodes

**Scope:**
- `orchestr8_next/city/notebook.py` - lines 28-30 (graph data colors), line 64 (CSS)
- `orchestr8_next/city/wiring.py` - lines 11, 21 (color parameters)
- `orchestr8_next/city/widget.py` - line 77 (JS color)
- `orchestr8_next/shell/layout.py` - multiple CSS colors
- `orchestr8_next/shell/views.py` - multiple color assignments

**Files with hardcoded colors:**
| File | Lines | Issue |
|------|-------|-------|
| city/notebook.py | 28-30, 64 | Hardcoded colors in graph data and CSS |
| city/wiring.py | 11, 21 | Hardcoded bgcolor and node color |
| city/widget.js | 77 | Hardcoded default color in JS |
| city/contracts.py | 36 | Default color value |
| shell/layout.py | 85-183 | Multiple CSS hardcodes |
| shell/views.py | 7-32 | Multiple style hardcodes |

**Test Gate:** N/A - this is optional cleanup, no tests verify specific color values outside settings service tests

**Rollback Plan:** Revert file changes from git - simple

**Dependencies:** None - completely independent

**Independence:** HIGH - can be done at any time

**Recommendation:** SKIP for now - these are low-priority cosmetic changes with no functional impact

---

### Phase 1: Clean Artifact Clutter

**Scope:** Move 24 files to artifacts directory, delete 7 log files

**Test Gate:** N/A - file system operations only, no code changes

**Rollback Plan:** Move files back to root - trivial

**Dependencies:** None - completely independent

**Independence:** HIGH - can be done at any time, provides immediate visual clarity

**Recommendation:** EXECUTE FIRST - zero risk, immediate benefit

---

### Phase 2: Fix sys.path Hacks

**Scope:** The ARCHITECTURE_SYNTHESIS.md references `plugins/04_connie_ui.py` with 3 sys.path hack instances (lines 97, 208, 281). However, this file does NOT exist in a_codex_plan. The orchestr8_next package has no sys.path manipulations.

**Current state in a_codex_plan:**
- No sys.path hacks found in `orchestr8_next/` directory
- The issues referenced are in the original Orchestr8_jr project

**Test Gate:** All 68 tests must pass

**Rollback Plan:** Revert changes from git

**Dependencies:** None - independent fix

**Independence:** MEDIUM - if files exist, changes are localized

**Recommendation:** N/A FOR a_codex_plan - issue is in source project, not this codebase

---

### Phase 3: Add L2 Service Facades

**Scope:** Add service facade layer for 06_maestro.py (which doesn't exist in a_codex_plan)

**Current state in a_codex_plan:**
- No `06_maestro.py` file exists
- The L1→L3 violations mentioned in ARCHITECTURE_SYNTHESIS.md refer to Orchestr8_jr structure

**Test Gate:** All 68 tests must pass

**Rollback Plan:** Revert new files

**Dependencies:** None if no changes needed

**Independence:** HIGH - if files don't exist, no work needed

**Recommendation:** N/A FOR a_codex_plan - issue is in source project

---

### Phase 4: woven_maps.py Import Restructure

**Scope:** The ARCHITECTURE_SYNTHESIS.md mentions L4→L3/L5 violations in woven_maps.py

**Current state in a_codex_plan:**
- File location: `orchestr8_next/visualization/` (does not exist yet in a_codex_plan)
- The city/ directory exists but has different structure

**Test Gate:** All 68 tests must pass

**Rollback Plan:** Revert changes from git

**Dependencies:** Requires proper L3 service boundaries to exist first

**Independence:** LOW - depends on earlier phases establishing service boundaries

**Recommendation:** DEFER - this is a future-phase concern, not applicable to current a_codex_plan structure

---

## 5. Dependency Graph

```
Phase 0 (Color tokens)
    |
    v
Phase 1 (Artifact cleanup) ----> [No dependencies - execute anytime]
    |
    v
Phase 2 (sys.path) ---------> [N/A for a_codex_plan]
    |
    v
Phase 3 (L2 facades) -------> [N/A for a_codex_plan]
    |
    v
Phase 4 (woven_maps) -------> [Requires L3 service boundaries]
```

---

## 6. Validated Recommended Order

| Priority | Phase | Action | Effort | Risk |
|----------|-------|--------|--------|------|
| 1 | Phase 1 | Execute artifact cleanup | 0.25h | NONE |
| 2 | Phase 0 | (OPTIONAL) Color token cleanup | 0.5h | LOW |
| - | Phase 2-4 | Not applicable to a_codex_plan | - | - |

---

## 7. Additional Findings

### 7.1 Pre-existing Test Failures

Two tests fail due to missing pytest-asyncio configuration:
- `tests/integration/test_comms_bridge.py::test_comms_bridge_dispatch`
- `tests/integration/test_comms_bridge.py::test_comms_bridge_timeout`

These failures existed before any cleanup work. Root cause: pytest.ini specifies `asyncio_mode = auto` but pytest-asyncio plugin is not installed or not properly configured.

**Recommended fix:** Either install pytest-asyncio or remove the asyncio config from pytest.ini.

### 7.2 Color Token Hardcodes Summary

The settings service (`orchestr8_next/settings/service.py`) correctly manages color tokens at lines 234-250. However, multiple files still have hardcoded colors that bypass the settings service:

- **Critical (affects theming):** shell/layout.py, shell/views.py
- **Low impact (demo data):** city/notebook.py lines 28-30
- **Legacy (unused):** city/wiring.py, city/contracts.py

---

## 8. Sources

### Primary Research
- File system inventory: Direct listing of `/home/bozertron/a_codex_plan/`
- Test execution: `pytest tests/ -v -o addopts=""`
- Color hardcode analysis: grep for hex color patterns
- Architecture reference: `.planning/research/ARCHITECTURE_SYNTHESIS.md`

### Confidence Assessment
- Artifact classification: HIGH - based on direct file inspection
- Cleanup commands: HIGH - verified file paths exist
- Phase validation: HIGH - based on actual code analysis
- Test gates: HIGH - verified by running test suite

---

## 9. Open Questions

1. **Question:** Should the B*_INTEGRATION_SMOKE_REPORT.md files in `/home/bozertron/Orchestr8_jr/.planning/orchestr8_next/artifacts/P07/` be kept separate from the ones in a_codex_plan root?
   - **What's unclear:** Whether these are duplicates or different reports
   - **Recommendation:** Keep separate - they're in different project directories

2. **Question:** Are the failed comms_bridge tests blocking migration?
   - **What we know:** They fail due to async config, not code issues
   - **What's unclear:** Whether they ever passed
   - **Recommendation:** Fix pytest-asyncio config before proceeding

3. **Question:** Does a_codex_plan need to implement any of the migration phases from ARCHITECTURE_SYNTHESIS.md?
   - **What we know:** The sys.path hacks and L1→L3 violations are in Orchestr8_jr, not a_codex_plan
   - **What's unclear:** If a_codex_plan has its own migration needs
   - **Recommendation:** a_codex_plan appears to be a clean implementation - only Phase 1 (cleanup) is applicable

---

*Research complete. Phase 1 (artifact cleanup) is the only required action for a_codex_plan.*
